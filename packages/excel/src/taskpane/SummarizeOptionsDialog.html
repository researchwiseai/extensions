<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <title>Summarize Options</title>
  <style>
    .pulse-btn { display:inline-flex; align-items:center; justify-content:center; padding:6px 10px; border-radius:4px; font-size:12px; font-weight:600; cursor:pointer; border:1px solid transparent; text-decoration:none; transition: background-color .15s ease, box-shadow .15s ease, border-color .15s ease, color .15s ease; box-shadow: 0 1px 2px rgba(0,0,0,.08); }
    .pulse-btn--primary { background:#0f766e; border-color:#0f766e; color:#fff; }
    .pulse-btn--primary:hover { background:#0d665f; }
    .pulse-btn--secondary { background:#fff; border-color:#0f766e; color:#0f766e; }
    .pulse-btn--secondary:hover { background:#f3f2f1; }
    body { font-family: 'Segoe UI', sans-serif; margin: 16px; }
    label { display: block; margin-top: 12px; font-weight: 600; }
    /* Ensure padding is included in width so the textarea truly spans the container */
    textarea { width: 100%; min-height: 80px; padding: 6px; box-sizing: border-box; }
    .presets { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 8px; }
    .row { display: flex; justify-content: flex-end; gap: 8px; margin-top: 16px; }
  </style>
  <script>
    function sendAndClose(payload) {
      Office.context.ui.messageParent(JSON.stringify(payload));
    }
    document.addEventListener('DOMContentLoaded', function () {
      const q = document.getElementById('questions');
      const params = new URLSearchParams(window.location.search);
      const defQ = params.get('defaultQuestion');
      if (defQ) { q.value = defQ; }
      const cancel = document.getElementById('cancelBtn');
      const ok = document.getElementById('okBtn');
      cancel.addEventListener('click', function () {
        sendAndClose({ question: null, preset: null });
      });
      ok.addEventListener('click', function () {
        const preset = document.querySelector('input[name="preset"]:checked')?.value || 'concise';
        sendAndClose({ question: q.value.trim(), preset });
      });
      q.focus();
    });
  </script>
</head>
<body>
  <label for="questions">Question(s)</label>
  <textarea id="questions" placeholder="e.g., What are the key takeaways and sentiment?&#10;You can add multiple questions on new lines."></textarea>

  <label>Preset</label>
  <div id="presets" class="presets"></div>

  

  <div class="row">
    <button id="cancelBtn" class="pulse-btn pulse-btn--secondary">Cancel</button>
    <button id="okBtn" class="pulse-btn pulse-btn--primary">OK</button>
  </div>
</body>
</html>
